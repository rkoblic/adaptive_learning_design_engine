{% extends "base.html" %}

{% block title %}Generated Course | Adaptive Learning Design Engine{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <!-- Progress Indicator -->
    <div class="mb-8">
        <div class="flex items-center justify-center space-x-4">
            <div class="flex items-center">
                <div class="w-10 h-10 rounded-full bg-green-500 text-white flex items-center justify-center font-bold">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <span class="ml-2 text-green-600">Input Details</span>
            </div>
            <div class="w-16 h-1 bg-green-500"></div>
            <div class="flex items-center">
                <div class="w-10 h-10 rounded-full bg-green-500 text-white flex items-center justify-center font-bold">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <span class="ml-2 text-green-600">Review & Confirm</span>
            </div>
            <div class="w-16 h-1 bg-green-500"></div>
            <div class="flex items-center">
                <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center font-bold">3</div>
                <span class="ml-2 font-medium text-primary">Generated Course</span>
            </div>
        </div>
    </div>

    <!-- Success Banner -->
    <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
        <div class="flex items-center">
            <svg class="w-6 h-6 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
            <div>
                <h3 class="font-medium text-green-800">Course Shell Generated Successfully</h3>
                <p class="text-sm text-green-700">Your complete curriculum is ready. Download or review below.</p>
            </div>
        </div>
    </div>

    <!-- Mobile Actions & View (shown on small screens) -->
    <div class="lg:hidden">
        <div class="mb-4 flex gap-2">
            <a href="{{ url_for('download_curriculum') }}" class="flex-1 flex items-center justify-center px-4 py-2 bg-primary text-white font-medium rounded-lg">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                Download
            </a>
            <button onclick="copyToClipboard()" class="flex-1 flex items-center justify-center px-4 py-2 bg-white border border-gray-300 text-gray-700 font-medium rounded-lg">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                </svg>
                Copy
            </button>
        </div>

        <!-- Mobile Section Cards (collapsible) -->
        <div id="mobile-sections" class="space-y-3">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>

    <!-- Two-Column Master/Detail Layout (hidden on mobile) -->
    <div class="master-detail-layout bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden" style="height: calc(100vh - 280px); min-height: 500px;">
        <div class="flex h-full">
            <!-- Left Column: Section Navigation (Master) -->
            <div class="w-72 flex-shrink-0 border-r border-gray-200 flex flex-col bg-gray-50">
                <!-- Header with actions -->
                <div class="p-4 border-b border-gray-200 bg-white">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-gray-900">Course Sections</h3>
                        <span class="text-xs text-gray-500" id="sectionCount">6 sections</span>
                    </div>
                    <div class="flex gap-2">
                        <a href="{{ url_for('download_curriculum') }}" class="flex-1 flex items-center justify-center px-3 py-2 text-xs font-medium text-white bg-primary rounded-lg hover:bg-indigo-700 transition-colors">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                            </svg>
                            Download
                        </a>
                        <button onclick="copyToClipboard()" class="flex-1 flex items-center justify-center px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>

                <!-- Section List -->
                <nav class="flex-1 overflow-y-auto p-2" id="section-nav">
                    <!-- Sections will be dynamically populated -->
                </nav>

                <!-- Footer Navigation -->
                <div class="p-3 border-t border-gray-200 bg-white text-sm space-y-1">
                    <a href="{{ url_for('back_to_confirm') }}" class="block text-gray-600 hover:text-primary">
                        &larr; Edit Inputs
                    </a>
                    <a href="{{ url_for('intake_form') }}" class="block text-gray-600 hover:text-primary">
                        Start New Course
                    </a>
                </div>
            </div>

            <!-- Right Column: Section Content (Detail) -->
            <div class="flex-1 flex flex-col min-w-0">
                <!-- Content Header -->
                <div class="px-6 py-4 border-b border-gray-200 bg-gray-50" id="detail-header">
                    <div class="flex items-center">
                        <span class="text-2xl mr-3" id="detail-icon">ðŸ“š</span>
                        <h2 class="text-xl font-semibold text-gray-900" id="detail-title">Select a section</h2>
                    </div>
                </div>

                <!-- Content Body -->
                <div class="flex-1 overflow-y-auto p-6" id="detail-content">
                    <div class="prose prose-indigo max-w-none" id="detail-prose">
                        <p class="text-gray-500">Select a section from the left to view its contents.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden original content for parsing -->
    <div class="prose prose-indigo max-w-none hidden" id="original-content">
        {{ curriculum_html|safe }}
    </div>

    <!-- Mobile Navigation Links -->
    <div class="lg:hidden mt-6 pt-4 border-t border-gray-200 flex justify-between text-sm">
        <a href="{{ url_for('back_to_confirm') }}" class="text-gray-600 hover:text-primary">
            &larr; Edit Inputs
        </a>
        <a href="{{ url_for('intake_form') }}" class="text-primary hover:underline">
            Start New Course
        </a>
    </div>

    <!-- Hidden textarea for clipboard -->
    <textarea id="markdown-content" class="hidden">{{ curriculum_markdown }}</textarea>
</div>

<!-- Back to Top Button -->
<button id="back-to-top" class="fixed bottom-8 right-8 p-3 bg-primary text-white rounded-full shadow-lg opacity-0 transition-opacity hover:bg-indigo-700" onclick="scrollToTop()">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
    </svg>
</button>

<!-- Toast Notification -->
<div id="toast" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 px-6 py-3 bg-gray-900 text-white rounded-lg shadow-lg opacity-0 transition-opacity">
    Copied to clipboard!
</div>
{% endblock %}

{% block scripts %}
<script>
    // Section configuration with colors and icons
    const sectionConfig = {
        'course': { color: 'blue', icon: 'ðŸ“š', title: 'Course Header' },
        'learning': { color: 'green', icon: 'ðŸŽ¯', title: 'Learning Objectives' },
        'weekly': { color: 'purple', icon: 'ðŸ“…', title: 'Weekly Schedule' },
        'reflection': { color: 'amber', icon: 'ðŸ’­', title: 'Reflection Prompts' },
        'assessment': { color: 'teal', icon: 'ðŸ“‹', title: 'Assessment Package' },
        'grading': { color: 'indigo', icon: 'ðŸ“Š', title: 'Grading Breakdown' }
    };

    // Color classes for each section type
    const colorClasses = {
        'blue': { bg: 'bg-blue-50', border: 'border-blue-300', text: 'text-blue-800', accent: 'bg-blue-500' },
        'green': { bg: 'bg-green-50', border: 'border-green-300', text: 'text-green-800', accent: 'bg-green-500' },
        'purple': { bg: 'bg-purple-50', border: 'border-purple-300', text: 'text-purple-800', accent: 'bg-purple-500' },
        'amber': { bg: 'bg-amber-50', border: 'border-amber-300', text: 'text-amber-800', accent: 'bg-amber-500' },
        'teal': { bg: 'bg-teal-50', border: 'border-teal-300', text: 'text-teal-800', accent: 'bg-teal-500' },
        'indigo': { bg: 'bg-indigo-50', border: 'border-indigo-300', text: 'text-indigo-800', accent: 'bg-indigo-500' }
    };

    // Store parsed sections globally
    let parsedSections = [];
    let currentSectionIndex = 0;

    // Determine section type from title
    function getSectionType(title) {
        const lowerTitle = title.toLowerCase();
        if (lowerTitle.includes('course') || lowerTitle.includes('header') || lowerTitle.includes('credit')) return 'course';
        if (lowerTitle.includes('learning') || lowerTitle.includes('objective')) return 'learning';
        if (lowerTitle.includes('weekly') || lowerTitle.includes('schedule') || lowerTitle.includes('week')) return 'weekly';
        if (lowerTitle.includes('reflection')) return 'reflection';
        if (lowerTitle.includes('assessment') || lowerTitle.includes('rubric') || lowerTitle.includes('evaluation')) return 'assessment';
        if (lowerTitle.includes('grading') || lowerTitle.includes('breakdown')) return 'grading';
        return 'course'; // default
    }

    // Initialize master/detail layout
    document.addEventListener('DOMContentLoaded', function() {
        const originalContent = document.getElementById('original-content');
        const sectionNav = document.getElementById('section-nav');

        // Parse content and group by H2 sections
        let currentSection = null;
        let preContent = []; // Content before first H2

        Array.from(originalContent.children).forEach(node => {
            if (node.tagName === 'H2') {
                if (currentSection) {
                    parsedSections.push(currentSection);
                }
                currentSection = {
                    title: node.textContent.trim(),
                    elements: [],
                    id: node.textContent.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '')
                };
            } else if (currentSection) {
                currentSection.elements.push(node.cloneNode(true));
            } else {
                preContent.push(node.cloneNode(true));
            }
        });
        if (currentSection) {
            parsedSections.push(currentSection);
        }

        // If there's pre-content (H1 title), add it as an Overview section at the beginning
        if (preContent.length > 0) {
            parsedSections.unshift({
                title: 'Course Overview',
                elements: preContent,
                id: 'course-overview',
                isOverview: true
            });
        }

        // Build section navigation
        parsedSections.forEach((section, index) => {
            const sectionType = getSectionType(section.title);
            const config = sectionConfig[sectionType] || sectionConfig['course'];
            const colors = colorClasses[config.color] || colorClasses['blue'];

            const navItem = document.createElement('button');
            navItem.className = `section-nav-item w-full text-left px-3 py-3 rounded-lg mb-1 transition-all duration-150 flex items-center group border-l-4 border-transparent hover:border-l-4`;
            navItem.dataset.index = index;
            navItem.dataset.color = config.color;
            navItem.onclick = () => selectSection(index);

            navItem.innerHTML = `
                <span class="text-xl mr-3 flex-shrink-0">${config.icon}</span>
                <div class="min-w-0 flex-1">
                    <div class="font-medium text-gray-900 truncate">${section.title}</div>
                    <div class="text-xs text-gray-500 truncate">${getPreview(section)}</div>
                </div>
            `;

            sectionNav.appendChild(navItem);
        });

        // Update section count
        document.getElementById('sectionCount').textContent = `${parsedSections.length} sections`;

        // Select the first section by default
        if (parsedSections.length > 0) {
            selectSection(0);
        }

        // Build mobile collapsible sections
        buildMobileSections();
    });

    // Build mobile collapsible sections
    function buildMobileSections() {
        const mobileContainer = document.getElementById('mobile-sections');
        if (!mobileContainer) return;

        parsedSections.forEach((section, index) => {
            const sectionType = getSectionType(section.title);
            const config = sectionConfig[sectionType] || sectionConfig['course'];
            const colors = colorClasses[config.color] || colorClasses['blue'];

            const card = document.createElement('div');
            card.className = 'mobile-section-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden';

            // Header
            const header = document.createElement('button');
            header.className = `w-full px-4 py-3 flex items-center justify-between ${colors.bg} border-b ${colors.border}`;
            header.onclick = () => toggleMobileSection(card);

            header.innerHTML = `
                <div class="flex items-center">
                    <span class="text-xl mr-2">${config.icon}</span>
                    <span class="font-medium ${colors.text}">${section.title}</span>
                </div>
                <svg class="mobile-chevron w-5 h-5 ${colors.text} transform transition-transform ${index === 0 ? 'rotate-180' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            `;

            // Content
            const content = document.createElement('div');
            content.className = `mobile-section-content p-4 prose prose-sm prose-indigo max-w-none ${index === 0 ? '' : 'hidden'}`;
            section.elements.forEach(el => {
                const cloned = el.cloneNode(true);
                content.appendChild(cloned);
            });

            // Apply special styling
            applySpecialStyling(content, section.title);

            card.appendChild(header);
            card.appendChild(content);
            mobileContainer.appendChild(card);
        });
    }

    // Toggle mobile section
    function toggleMobileSection(card) {
        const content = card.querySelector('.mobile-section-content');
        const chevron = card.querySelector('.mobile-chevron');
        content.classList.toggle('hidden');
        chevron.classList.toggle('rotate-180');
    }

    // Get a brief preview of section content
    function getPreview(section) {
        if (section.isOverview) return 'Course title and info';
        const firstPara = section.elements.find(el => el.tagName === 'P');
        if (firstPara) {
            const text = firstPara.textContent.trim();
            return text.length > 40 ? text.substring(0, 40) + '...' : text;
        }
        const listItems = section.elements.filter(el => el.tagName === 'UL' || el.tagName === 'OL');
        if (listItems.length > 0) {
            const count = listItems.reduce((sum, list) => sum + list.querySelectorAll('li').length, 0);
            return `${count} items`;
        }
        return 'Click to view';
    }

    // Select and display a section
    function selectSection(index) {
        currentSectionIndex = index;
        const section = parsedSections[index];
        const sectionType = getSectionType(section.title);
        const config = sectionConfig[sectionType] || sectionConfig['course'];
        const colors = colorClasses[config.color] || colorClasses['blue'];

        // Update navigation active states
        document.querySelectorAll('.section-nav-item').forEach((item, i) => {
            const itemColor = item.dataset.color;
            const itemColors = colorClasses[itemColor] || colorClasses['blue'];

            if (i === index) {
                item.classList.add(itemColors.bg, itemColors.border, 'border-l-4');
                item.classList.remove('hover:bg-gray-100', 'border-transparent');
            } else {
                item.classList.remove(...Object.values(colorClasses).flatMap(c => [c.bg, c.border]));
                item.classList.add('hover:bg-gray-100', 'border-transparent');
            }
        });

        // Update detail header
        const detailHeader = document.getElementById('detail-header');
        detailHeader.className = `px-6 py-4 border-b ${colors.bg} ${colors.border}`;
        document.getElementById('detail-icon').textContent = config.icon;
        document.getElementById('detail-title').textContent = section.title;
        document.getElementById('detail-title').className = `text-xl font-semibold ${colors.text}`;

        // Update detail content
        const detailProse = document.getElementById('detail-prose');
        detailProse.innerHTML = '';

        // Clone and append section elements
        section.elements.forEach(el => {
            const cloned = el.cloneNode(true);
            detailProse.appendChild(cloned);
        });

        // Apply special styling based on section type
        applySpecialStyling(detailProse, section.title);

        // Scroll detail content to top
        document.getElementById('detail-content').scrollTop = 0;
    }

    // Apply special styling for specific section types
    function applySpecialStyling(container, title) {
        const lowerTitle = title.toLowerCase();

        // Style Learning Objectives section
        if (lowerTitle.includes('learning objectives')) {
            container.querySelectorAll('h4').forEach(h4 => {
                if (h4.textContent.toLowerCase().includes('fixed objectives')) {
                    h4.classList.add('objective-subheader', 'objective-fixed');
                } else if (h4.textContent.toLowerCase().includes('variable objectives')) {
                    h4.classList.add('objective-subheader', 'objective-variable');
                }
            });
        }

        // Style Weekly Schedule section
        if (lowerTitle.includes('weekly schedule')) {
            container.querySelectorAll('h3').forEach(h3 => {
                if (h3.textContent.toLowerCase().startsWith('week')) {
                    h3.classList.add('week-header');
                }
            });
            // Style Kolb cycle phase headers
            container.querySelectorAll('h4').forEach(h4 => {
                const text = h4.textContent.toLowerCase();
                if (text.includes('concrete experience')) {
                    h4.classList.add('kolb-phase', 'kolb-experience');
                } else if (text.includes('reflective observation')) {
                    h4.classList.add('kolb-phase', 'kolb-reflection');
                } else if (text.includes('abstract conceptualization')) {
                    h4.classList.add('kolb-phase', 'kolb-conceptualization');
                } else if (text.includes('active experimentation')) {
                    h4.classList.add('kolb-phase', 'kolb-experimentation');
                } else if (text.includes('deliverables due')) {
                    h4.classList.add('kolb-phase', 'kolb-deliverables');
                } else if (text.includes('milestone')) {
                    h4.classList.add('kolb-phase', 'kolb-milestone');
                }
            });
        }
    }

    // Copy to clipboard
    function copyToClipboard() {
        const content = document.getElementById('markdown-content').value;
        navigator.clipboard.writeText(content).then(() => {
            showToast('Copied to clipboard!');
        }).catch(() => {
            const textarea = document.getElementById('markdown-content');
            textarea.classList.remove('hidden');
            textarea.select();
            document.execCommand('copy');
            textarea.classList.add('hidden');
            showToast('Copied to clipboard!');
        });
    }

    // Show toast notification
    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.classList.remove('opacity-0');
        toast.classList.add('opacity-100');
        setTimeout(() => {
            toast.classList.remove('opacity-100');
            toast.classList.add('opacity-0');
        }, 2000);
    }

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowDown' && currentSectionIndex < parsedSections.length - 1) {
            e.preventDefault();
            selectSection(currentSectionIndex + 1);
        } else if (e.key === 'ArrowUp' && currentSectionIndex > 0) {
            e.preventDefault();
            selectSection(currentSectionIndex - 1);
        }
    });
</script>

<style>
    /* Master/Detail Layout */
    .master-detail-layout {
        display: flex;
        flex-direction: column;
    }

    /* Section Navigation Item Styling */
    .section-nav-item {
        background: transparent;
    }
    .section-nav-item:hover {
        background: rgba(0, 0, 0, 0.03);
    }
    .section-nav-item:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);
    }

    /* Prose styling for curriculum content */
    .prose h1 {
        @apply text-3xl font-bold text-gray-900 border-b border-gray-200 pb-4 mb-6;
    }
    .prose h2 {
        @apply text-2xl font-bold text-gray-800 mt-8 mb-4;
    }
    .prose h3 {
        @apply text-xl font-semibold text-gray-700 mt-6 mb-3;
    }
    .prose h4 {
        @apply text-lg font-medium text-gray-700 mt-4 mb-2;
    }

    /* Learning Objectives subheader styling */
    .objective-subheader {
        @apply text-base font-semibold py-2 px-4 rounded-lg mt-6 mb-4 border-l-4;
    }
    .objective-fixed {
        @apply bg-emerald-50 text-emerald-800 border-emerald-500;
    }
    .objective-variable {
        @apply bg-blue-50 text-blue-800 border-blue-500;
    }

    /* Week header styling within Weekly Schedule */
    .week-header {
        @apply text-lg font-semibold py-3 px-4 rounded-lg mt-8 mb-4 bg-purple-50 text-purple-800 border-l-4 border-purple-500;
    }
    .week-header:first-of-type {
        @apply mt-0;
    }

    /* Kolb cycle phase styling */
    .kolb-phase {
        @apply text-sm font-semibold uppercase tracking-wide py-2 px-3 rounded mt-5 mb-2 inline-block;
    }
    .kolb-experience {
        @apply bg-orange-100 text-orange-700;
    }
    .kolb-reflection {
        @apply bg-sky-100 text-sky-700;
    }
    .kolb-conceptualization {
        @apply bg-violet-100 text-violet-700;
    }
    .kolb-experimentation {
        @apply bg-emerald-100 text-emerald-700;
    }
    .kolb-deliverables {
        @apply bg-rose-100 text-rose-700;
    }
    .kolb-milestone {
        @apply bg-amber-100 text-amber-700;
    }

    /* Add spacing after kolb phase content */
    .kolb-phase + p,
    .kolb-phase + ul {
        @apply mt-2 mb-4 pl-3 border-l-2 border-gray-200;
    }
    .prose p {
        @apply text-gray-600 leading-relaxed mb-4;
    }
    .prose ul, .prose ol {
        @apply my-4 pl-6;
    }
    .prose li {
        @apply text-gray-600 mb-2;
    }
    .prose table {
        @apply w-full border-collapse border border-gray-300 my-6;
    }
    .prose th {
        @apply bg-gray-100 border border-gray-300 px-4 py-2 text-left font-semibold text-gray-700;
    }
    .prose td {
        @apply border border-gray-300 px-4 py-2 text-gray-600;
    }
    .prose code {
        @apply bg-gray-100 px-1 py-0.5 rounded text-sm;
    }
    .prose pre {
        @apply bg-gray-100 p-4 rounded-lg overflow-x-auto my-4;
    }
    .prose blockquote {
        @apply border-l-4 border-indigo-500 pl-4 my-4 italic text-gray-600;
    }
    .prose hr {
        @apply my-8 border-gray-200;
    }

    /* Smooth transitions */
    .section-nav-item {
        transition: all 0.15s ease-in-out;
    }

    /* Detail content scrollbar styling */
    #detail-content::-webkit-scrollbar {
        width: 8px;
    }
    #detail-content::-webkit-scrollbar-track {
        background: #f1f5f9;
    }
    #detail-content::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
    }
    #detail-content::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
    }

    /* Section nav scrollbar styling */
    #section-nav::-webkit-scrollbar {
        width: 6px;
    }
    #section-nav::-webkit-scrollbar-track {
        background: transparent;
    }
    #section-nav::-webkit-scrollbar-thumb {
        background: #e2e8f0;
        border-radius: 3px;
    }

    /* Desktop: Show master/detail layout */
    @media (min-width: 1024px) {
        .master-detail-layout {
            display: block;
        }
    }

    /* Mobile: Hide master/detail, show collapsible sections */
    @media (max-width: 1023px) {
        .master-detail-layout {
            display: none !important;
        }
    }

    /* Mobile section card styling */
    .mobile-section-card button:focus {
        outline: none;
    }
    .mobile-section-content {
        transition: all 0.2s ease-in-out;
    }

    /* Print styles - show all content expanded */
    @media print {
        .master-detail-layout {
            display: block !important;
            height: auto !important;
            overflow: visible !important;
        }
        .master-detail-layout > div {
            display: block !important;
        }
        .master-detail-layout > div > div:first-child {
            display: none !important; /* Hide sidebar */
        }
        .master-detail-layout > div > div:last-child {
            flex: none !important;
            overflow: visible !important;
        }
        #detail-content {
            overflow: visible !important;
        }
        #back-to-top, #toast {
            display: none !important;
        }
    }
</style>
{% endblock %}
